<class name="card client">
    Helps to communicate with Virgil Card Service.


    <require class="str buffer" project="common"/>
    <require class="json object"/>
    <require class="json array"/>
    <require class="raw card list" api="private"/>


    <property name="base url" class="str mutable"/>


    <constant name="k base url" type="string" visibility="private">
        Base service URL.

        <value value="https://api.virgilsecurity.com"/>
    </constant>


    <constant name="k url path card" type="string" visibility="private" >
        POST|GET /card.

        <value value="/card/v5"/>
    </constant>


    <constant name="k url path search" type="string" visibility="private" >
        POST /actions/search.

        <value value="/card/v5/actions/search"/>
    </constant>


    <constant name="k url path revoke" type="string" visibility="private" >
        POST /actions/revoke.

        <value value="/card/v5/actions/revoke"/>
    </constant>


    <constant name="k json key identity" type="string" visibility="private" >
        Json KEY: identity.

        <value value="identity"/>
    </constant>


    <constant name="k header name x virgil is superseeded" type="string" visibility="private" >
        HTTP Header name: X-Virgil-Is-Superseeded

        <value value="X-Virgil-Is-Superseeded"/>
    </constant>


    <constructor name="with base url">
        Create Card Client with a given Virgil Base URL, aka https://api.virgilsecurity.com

        <argument name="url" class="str"/>
    </constructor>


    <method name="make request publish card" is_const="1">
         Create request that creates Virgil Card instance on the Virgil Cards Service.

         Also makes the Card accessible for search/get queries from other users.
         Note, "raw card" should contain appropriate signatures.

        <argument name="raw card" class="raw card"/>

        <return class="http request" access="disown"/>
    </method>


    <method name="process response publish card" is_static="1">
        Map response to the correspond model.
        Return "raw card" of published Card.

        <argument name="response" class="virgil http response"/>
        <argument name="error" class="error" access="readwrite"/>

        <return class="raw card" access="disown"/>
    </method>


    <method name="make request get card" is_const="1">
         Create request that returns card from the Virgil Cards Service with given ID, if exists.

        <argument name="card id" class="str"/>

        <return class="http request" access="disown"/>
    </method>


    <method name="process response get card" is_static="1">
        Map response to the correspond model.
        Return "raw card" if Card was found.

        <argument name="response" class="virgil http response"/>
        <argument name="error" class="error" access="readwrite"/>

        <return class="raw card" access="disown"/>
    </method>


    <method name="make request search cards with identity" is_const="1">
         Create request that returns cards list from the Virgil Cards Service for given identity.

        <argument name="identity" class="str"/>

        <return class="http request" access="disown"/>
    </method>


    <method name="process response search cards" is_static="1">
        Map response to the correspond model.
        Return "raw card list" if founded Cards.

        <argument name="response" class="virgil http response"/>
        <argument name="error" class="error" access="readwrite"/>

        <return class="raw card list" access="disown"/>
    </method>


    <method name="make request revoke card with id" is_const="1">
        Revoke an active Virgil Card using its ID only.

        Note, only HTTP status might be checked within a correspond response.

        <argument name="card id" class="str"/>

        <return class="http request" access="disown"/>
    </method>
</class>
